(self.webpackChunkchicken_feet_web=self.webpackChunkchicken_feet_web||[]).push([[8769],{8769:(t,e,n)=>{"use strict";n.r(e),n.d(e,{HallPageModule:()=>w});var o=n(8583),i=n(665),s=n(3083),r=n(8136),a=n(205),c=n(5917),u=n(9773),g=n(1406),l=n(639),p=n(1841);let m=(()=>{class t{constructor(t){this.http=t,this.ok=g.Z.ok}postLogout(){return this.http.post("auth/logout",null).pipe((0,u.zg)(t=>t.result<this.ok?(0,a._)(t.message):(0,c.of)(t.result)))}getGameList(t){return this.http.get(`games/${t}`).pipe((0,u.zg)(t=>t.result<this.ok?(0,a._)(t.message):(0,c.of)(t.data)))}postJoinGame(t){return this.http.post(`games/${t}/participants`,null).pipe((0,u.zg)(t=>t.result<this.ok?(0,a._)(t.message):(0,c.of)(t.result)))}}return t.\u0275fac=function(e){return new(e||t)(l.LFG(p.eN))},t.\u0275prov=l.Yz7({token:t,factory:t.\u0275fac}),t})();function h(t,e){1&t&&(l.TgZ(0,"div",2),l.TgZ(1,"strong",3),l._uU(2,"\u6682\u65e0\u9e21\u811a\u53ef\u753b"),l.qZA(),l.qZA())}function f(t,e){if(1&t){const t=l.EpF();l.TgZ(0,"ion-item"),l.TgZ(1,"ion-label"),l.TgZ(2,"h2"),l._uU(3),l.qZA(),l.TgZ(4,"p"),l._uU(5,"\u5df2\u6709"),l.TgZ(6,"strong",7),l._uU(7),l.qZA(),l._uU(8,"\u4eba\u52a0\u5165"),l.qZA(),l.qZA(),l.TgZ(9,"ion-button",8),l.NdJ("click",function(){const e=l.CHM(t).$implicit;return l.oxw(2).joinGame(e.id)}),l._uU(10,"\u52a0\u5165"),l.qZA(),l.qZA()}if(2&t){const t=e.$implicit;l.xp6(3),l.hij("\u540d\u79f0\uff1a",t.name,""),l.xp6(4),l.Oqu(t.participants.length)}}function Z(t,e){if(1&t&&(l.TgZ(0,"ion-list",4),l.TgZ(1,"ion-list-header",5),l._uU(2,"\u8bf7\u9009\u62e9\u70b9\u51fb\u52a0\u5165"),l.qZA(),l.YNc(3,f,11,2,"ion-item",6),l.qZA()),2&t){const t=l.oxw();l.xp6(3),l.Q6J("ngForOf",t.gameList)}}let d=(()=>{class t{constructor(){this.join=new l.vpe}joinGame(t){this.join.emit(t)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=l.Xpm({type:t,selectors:[["app-newgame"]],inputs:{gameList:"gameList"},outputs:{join:"join"},decls:2,vars:2,consts:[["id","main",4,"ngIf"],["class","padding-top-0",4,"ngIf"],["id","main"],[1,"empty-tip"],[1,"padding-top-0"],["color","light",1,"ion-header-tip"],[4,"ngFor","ngForOf"],[1,"game-extrainfo-tip"],["slot","end","size","default",3,"click"]],template:function(t,e){1&t&&(l.YNc(0,h,3,0,"div",0),l.YNc(1,Z,4,1,"ion-list",1)),2&t&&(l.Q6J("ngIf",!1),l.xp6(1),l.Q6J("ngIf",!0))},directives:[o.O5,s.q_,s.yh,o.sg,s.Ie,s.Q$,s.YG],styles:[".game-extrainfo-tip[_ngcontent-%COMP%]{margin:0 8px;color:var(--ion-color-secondary)}",".empty-tip[_ngcontent-%COMP%]{font-size:30px}"]}),t})(),b=(()=>{class t{constructor(t){this.router=t}ngOnInit(){}checkGameResult(){this.router.navigate(["/personal-game-result"])}}return t.\u0275fac=function(e){return new(e||t)(l.Y36(r.F0))},t.\u0275cmp=l.Xpm({type:t,selectors:[["app-overedgame"]],decls:11,vars:1,consts:[[1,"game-extrainfo-tip"],["slot","end","size","default",3,"click"]],template:function(t,e){1&t&&(l.TgZ(0,"ion-list"),l.TgZ(1,"ion-item"),l.TgZ(2,"ion-label"),l.TgZ(3,"h2"),l._uU(4,"\u6e38\u620f\u540d\u79f0"),l.qZA(),l.TgZ(5,"p"),l._uU(6,"\u72b6\u6001"),l.TgZ(7,"strong",0),l._uU(8),l.qZA(),l.qZA(),l.qZA(),l.TgZ(9,"ion-button",1),l.NdJ("click",function(){return e.checkGameResult()}),l._uU(10,"\u67e5\u770b"),l.qZA(),l.qZA(),l.qZA()),2&t&&(l.xp6(8),l.Oqu("\u8fdb\u884c\u4e2d | \u5df2\u5b8c\u6210"))},directives:[s.q_,s.Ie,s.Q$,s.YG],styles:[".game-extrainfo-tip[_ngcontent-%COMP%]{margin:0 8px;color:var(--ion-color-secondary)}",""]}),t})();function v(t,e){if(1&t){const t=l.EpF();l.TgZ(0,"app-newgame",10),l.NdJ("join",function(e){return l.CHM(t),l.oxw().joinGame(e)}),l.qZA()}if(2&t){const t=l.oxw();l.Q6J("gameList",t.gameList)}}function q(t,e){1&t&&l._UZ(0,"app-overedgame")}const A=[{path:"",component:(()=>{class t{constructor(t,e){this.router=t,this.hallService=e,this.postLSub=null,this.postJGSub=null,this.gameList=[]}ngAfterViewInit(){this.refresh()}showPage(t){return!!this.ionSegment&&this.ionSegment.value===t}logout(){localStorage.removeItem("token"),this.postLSub=this.hallService.postLogout().subscribe(t=>this.router.navigate(["/home"]),t=>{console.warn(t),this.router.navigate(["/home"])})}refresh(){const t=this.hallService.getGameList(this.ionSegment.value).subscribe(e=>{this.gameList.splice(0,this.gameList.length,...e),t.unsubscribe()},t=>{console.error(t)})}joinGame(t){this.postJGSub=this.hallService.postJoinGame(t).subscribe(t=>this.router.navigate(["/waiting"]),t=>{console.error(t),"not logged in"==t&&this.router.navigate(["/register"])})}ngOnDestroy(){null!=this.postLSub&&this.postLSub.unsubscribe(),null!=this.postJGSub&&this.postJGSub.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(l.Y36(r.F0),l.Y36(m))},t.\u0275cmp=l.Xpm({type:t,selectors:[["app-hall"]],viewQuery:function(t,e){if(1&t&&l.Gf(s.cJ,5),2&t){let t;l.iGM(t=l.CRH())&&(e.ionSegment=t.first)}},features:[l._Bn([m])],decls:20,vars:2,consts:[["mode","ios"],["slot","start"],[3,"click"],[1,"ion-text-center"],["slot","end"],[3,"gameList","join",4,"ngIf"],[4,"ngIf"],[1,"ion-no-border"],["value","new"],["value","overed"],[3,"gameList","join"]],template:function(t,e){1&t&&(l.TgZ(0,"ion-header"),l.TgZ(1,"ion-toolbar",0),l.TgZ(2,"ion-buttons",1),l.TgZ(3,"ion-button",2),l.NdJ("click",function(){return e.logout()}),l._uU(4," \u767b\u51fa "),l.qZA(),l.qZA(),l.TgZ(5,"ion-title",3),l._uU(6,"\u9e21\u5e02\u573a"),l.qZA(),l.TgZ(7,"ion-buttons",4),l.TgZ(8,"ion-button",2),l.NdJ("click",function(){return e.refresh()}),l._uU(9," \u5237\u65b0 "),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.TgZ(10,"ion-content"),l.YNc(11,v,1,1,"app-newgame",5),l.YNc(12,q,1,0,"app-overedgame",6),l.qZA(),l.TgZ(13,"ion-footer",7),l.TgZ(14,"ion-toolbar"),l.TgZ(15,"ion-segment",8),l.TgZ(16,"ion-segment-button",8),l._uU(17," \u65b0\u6e38\u620f "),l.qZA(),l.TgZ(18,"ion-segment-button",9),l._uU(19," \u5df2\u5b8c\u6210 "),l.qZA(),l.qZA(),l.qZA(),l.qZA()),2&t&&(l.xp6(11),l.Q6J("ngIf",e.showPage("new")),l.xp6(1),l.Q6J("ngIf",e.showPage("overed")))},directives:[s.Gu,s.sr,s.Sm,s.YG,s.wd,s.W2,o.O5,s.fr,s.cJ,s.QI,s.GO,d,b],styles:[".game-extrainfo-tip[_ngcontent-%COMP%]{margin:0 8px;color:var(--ion-color-secondary)}"]}),t})()}];let T=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=l.oAB({type:t}),t.\u0275inj=l.cJS({imports:[[r.Bz.forChild(A)],r.Bz]}),t})();var _=n(6538);let w=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=l.oAB({type:t}),t.\u0275inj=l.cJS({providers:[{provide:p.TP,useClass:_.Q,multi:!0}],imports:[[o.ez,i.u5,p.JF,s.Pc,T]]}),t})()}}]);