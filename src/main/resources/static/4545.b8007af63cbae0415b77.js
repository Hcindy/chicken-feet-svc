(self.webpackChunkchicken_feet_web=self.webpackChunkchicken_feet_web||[]).push([[4545],{4545:(e,t,i)=>{"use strict";i.r(t),i.d(t,{WaitingPageModule:()=>p});var n=i(8583),s=i(665),a=i(3083),r=i(8136),o=i(639),c=i(4268);const u=function(e){return["/gaming",e]};function m(e,t){if(1&e&&(o.TgZ(0,"ion-footer",9),o.TgZ(1,"ion-button",10),o._uU(2),o.qZA(),o.qZA()),2&e){const e=o.oxw();o.xp6(1),o.Q6J("disabled",e.enterGame.disabled)("routerLink",o.VKq(3,u,e.game.id)),o.xp6(1),o.hij("",e.enterGame.message," ")}}const l=[{path:"",component:(()=>{class e{constructor(e,t){this.router=e,this.waitingService=t,this.game={id:"",name:"",bonuses:[],participants:[],startTime:null,endTime:null},this.statistic={nameTotal:"-",amountTotal:"-",worthTotal:"-"},this.enterGame={disabled:!0,checkInterval:null,countdown:-1,message:"\u5373\u5c06\u5f00\u59cb"}}ngOnInit(){this.refresh()}ngOnDestroy(){this.resetEnterGame()}resetEnterGame(){clearInterval(this.enterGame.checkInterval),this.enterGame.checkInterval=null}refresh(){const e=this.waitingService.getAccountJoinedGameId().subscribe(t=>{e.unsubscribe();const i=this.waitingService.getGame(t).subscribe(e=>{i.unsubscribe(),this.game.id=e.id,this.game.name=e.name,this.game.bonuses.splice(0,this.game.bonuses.length,...e.bonuses),this.game.participants.splice(0,this.game.participants.length,...e.participants),this.game.startTime=e.startTime,this.game.endTime=e.endTime,this.init()},e=>{i.unsubscribe(),console.error(e)})},t=>{e.unsubscribe(),console.error(t)})}init(){this.resetEnterGame(),null==this.game.startTime?this.enterGame.disabled=!0:(this.enterGame.checkInterval=window.setInterval(()=>{this.enterGame.countdown-=1,this.enterGame.countdown<0?(this.enterGame.disabled=!1,this.enterGame.message="\u5f00\u59cb\u6e38\u620f",this.resetEnterGame()):this.enterGame.countdown>30?(this.enterGame.disabled=!0,this.enterGame.message="\u5373\u5c06\u5f00\u59cb"):(this.enterGame.disabled=!0,this.enterGame.message=`\u5012\u8ba1\u65f6 ${this.enterGame.countdown}S`)},1e3),this.enterGame.countdown=Math.ceil((this.game.startTime-(new Date).getTime())/1e3)),this.statistic.worthTotal=this.game.bonuses.reduce((e,t)=>e+t.amount*t.worth,0)}exitGame(){const e=this.waitingService.deleteExitGame(this.game.id).subscribe(t=>{e.unsubscribe(),this.router.navigate(["/hall"])},t=>{console.warn(t),e.unsubscribe(),this.router.navigate(["/hall"])})}toGameParticipant(){this.router.navigate(["/waiting/game-participant"])}toGameBonus(){this.router.navigate(["/waiting/game-bonus"])}}return e.\u0275fac=function(t){return new(t||e)(o.Y36(r.F0),o.Y36(c.t))},e.\u0275cmp=o.Xpm({type:e,selectors:[["app-waiting"]],decls:43,vars:12,consts:[["mode","ios"],["slot","start"],[3,"click"],[1,"ion-text-center"],["slot","end"],[1,"ion-text-wrap"],["detail","",3,"click"],["color","tertiary"],["class","ion-no-border",4,"ngIf"],[1,"ion-no-border"],["shape","round","expand","full","fill","outline",3,"disabled","routerLink"]],template:function(e,t){1&e&&(o.TgZ(0,"ion-header"),o.TgZ(1,"ion-toolbar",0),o.TgZ(2,"ion-buttons",1),o.TgZ(3,"ion-button",2),o.NdJ("click",function(){return t.exitGame()}),o._uU(4," \u9000\u51fa "),o.qZA(),o.qZA(),o.TgZ(5,"ion-title",3),o._uU(6,"\u5019\u9e21\u5ba4"),o.qZA(),o.TgZ(7,"ion-buttons",4),o.TgZ(8,"ion-button",2),o.NdJ("click",function(){return t.refresh()}),o._uU(9," \u5237\u65b0 "),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.TgZ(10,"ion-content"),o.TgZ(11,"ion-list"),o.TgZ(12,"ion-item"),o.TgZ(13,"ion-label",5),o.TgZ(14,"strong"),o._uU(15),o.qZA(),o.qZA(),o.qZA(),o.TgZ(16,"ion-item",6),o.NdJ("click",function(){return t.toGameParticipant()}),o.TgZ(17,"ion-label",5),o._uU(18,"\u53c2\u4e0e\u8005"),o.qZA(),o.TgZ(19,"ion-chip",7),o.TgZ(20,"ion-label"),o._uU(21),o.qZA(),o.qZA(),o.qZA(),o.TgZ(22,"ion-item",6),o.NdJ("click",function(){return t.toGameBonus()}),o.TgZ(23,"ion-label",5),o._uU(24,"\u5956\u6c60"),o.qZA(),o.TgZ(25,"ion-chip",7),o.TgZ(26,"ion-label"),o._uU(27),o.qZA(),o.qZA(),o.qZA(),o.TgZ(28,"ion-item"),o.TgZ(29,"ion-label",5),o._uU(30,"\u5f00\u59cb\u65f6\u95f4"),o.qZA(),o.TgZ(31,"ion-chip",7),o.TgZ(32,"ion-label"),o._uU(33),o.ALo(34,"date"),o.qZA(),o.qZA(),o.qZA(),o.TgZ(35,"ion-item"),o.TgZ(36,"ion-label",5),o._uU(37,"\u7ed3\u675f\u65f6\u95f4"),o.qZA(),o.TgZ(38,"ion-chip",7),o.TgZ(39,"ion-label"),o._uU(40),o.ALo(41,"date"),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.qZA(),o.YNc(42,m,3,5,"ion-footer",8)),2&e&&(o.xp6(15),o.Oqu(t.game.name),o.xp6(6),o.Oqu(t.game.participants.length),o.xp6(6),o.Oqu(t.statistic.worthTotal),o.xp6(6),o.Oqu(t.game.startTime?o.xi3(34,6,t.game.startTime,"yyyy/MM/dd hh:mm:ss"):"\u6682\u672a\u8bbe\u5b9a"),o.xp6(7),o.Oqu(t.game.endTime?o.xi3(41,9,t.game.endTime,"yyyy/MM/dd hh:mm:ss"):"\u6682\u672a\u8bbe\u5b9a"),o.xp6(2),o.Q6J("ngIf",t.game.startTime))},directives:[a.Gu,a.sr,a.Sm,a.YG,a.wd,a.W2,a.q_,a.Ie,a.Q$,a.hM,n.O5,a.fr,a.YI,r.rH],pipes:[n.uU],styles:[""]}),e})()},{path:"game-participant",loadChildren:()=>i.e(1763).then(i.bind(i,1763)).then(e=>e.GameParticipantPageModule)},{path:"game-bonus",loadChildren:()=>i.e(2535).then(i.bind(i,2535)).then(e=>e.GameBonusPageModule)}];let h=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.oAB({type:e}),e.\u0275inj=o.cJS({imports:[[r.Bz.forChild(l)],r.Bz]}),e})();var g=i(1841),d=i(6538);let p=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=o.oAB({type:e}),e.\u0275inj=o.cJS({providers:[{provide:g.TP,useClass:d.Q,multi:!0},c.t],imports:[[n.ez,s.u5,g.JF,a.Pc,h]]}),e})()},4268:(e,t,i)=>{"use strict";i.d(t,{t:()=>u});var n=i(1406),s=i(205),a=i(5917),r=i(9773),o=i(639),c=i(1841);let u=(()=>{class e{constructor(e){this.http=e,this.ok=n.Z.ok}getAccountJoinedGameId(){return this.http.get("accounts").pipe((0,r.zg)(e=>e.result<this.ok?(0,s._)(e.message):(0,a.of)(e.data)))}getGame(e){return this.http.get(`games/${e}`).pipe((0,r.zg)(e=>e.result<this.ok?(0,s._)(e.message):(0,a.of)(e.data)))}deleteExitGame(e){return this.http.delete(`games/${e}/participants`).pipe((0,r.zg)(e=>e.result<this.ok?(0,s._)(e.message):(0,a.of)(e.result)))}}return e.\u0275fac=function(t){return new(t||e)(o.LFG(c.eN))},e.\u0275prov=o.Yz7({token:e,factory:e.\u0275fac}),e})()}}]);